from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.common.by import By
from openpyxl import load_workbook, Workbook
from zenrows import ZenRowsClient
from shutil import copyfile
import openpyxl
import math
import requests
import datetime
import pandas as pd
import json
import os
from datetime import date
import time
import traceback


def data_to_database(product_json_final, matched_cate):
    list_length = len(product_json_final)
    if list_length > 0:
        print(len(product_json_final))
        input("NNNNNNNNn")
        if len(product_json_final) < 51:
            dataj = {
                "portal": "Caseparts",
                "category": matched_cate,
                "products": product_json_final,
            }
            json_data = dataj
            print(json_data)
            headers = {
                "Content-Type": "application/json",
                "Authorization": "Bearer RAP@BOT",
            }
            # response = requests.post("http://206.189.137.81:5052/api/v1/raw-data/", headers=headers, json=json_data)
            response = requests.post(
                "https://hussmannxref.rapidautomation.ai/api/v1/raw-data",
                headers=headers,
                json=json_data,
            )
            print("--", response)
            # print(response.raise_for_status())
        else:
            divisor = math.ceil(list_length) / 50
            divisor = int(divisor)
            start = 0
            end = 50
            for i in range(0, divisor):
                new_list = product_json_final[start:end]
                start += 50
                end += 50
                dataj = {
                    "portal": "Caseparts",
                    "category": matched_cate,
                    "products": new_list,
                }
            json_data = dataj
            headers = {
                "Content-Type": "application/json",
                "Authorization": "Bearer RAP@BOT",
            }
            # response = requests.post("http://206.189.137.81:5052/api/v1/raw-data/", headers=headers, json=json_data)
            response = requests.post(
                "https://hussmannxref.rapidautomation.ai/api/v1/raw-data",
                headers=headers,
                json=json_data,
            )
            print("---", response)
            # print(response.raise_for_status())
        print(len(dataj["products"]), " data inserted to database")


parts =["condenser","condensing unit","cooler","core","distributor","drier","evaporator","filter","orifice","pump","receiver","regulator","sight glass",'solenoid',"tank","tube",'valve',"valve-ball","valve-check","valve-solenoid","harness-shelf","product stop"]
product_json_final =[{'recognized_attributes': {'sku': '914303', 'url': 'https://caseparts.com/Part/914303/True-Evaporator-Coils', 'title': 'evaporator', 'main-description': '30 x 5 x 2-1/8 Evaporator Coil For True', 'product-id': '914303', 'oem-product-id': '914303', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'Fin Dimensions': '30 x 5 x 2-1/8', 'Style': 'Evaporator', 'Weight': '4.10'}}]}, {'recognized_attributes': {'sku': '914920', 'url': 'https://caseparts.com/Part/914920/True-Evaporator-Coils', 'title': 'evaporator', 'main-description': '30 x 5 x 2-1/8 Evaporator Coil For True', 'product-id': '914920', 'oem-product-id': '914920', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'Fin Dimensions': '30 x 5 x 2-1/8', 'Style': 'Evaporator', 'Weight': '4.00'}}]}, {'recognized_attributes': {'sku': '800245', 'url': 'https://caseparts.com/Part/800245/True-Evaporator-Coils', 'title': 'evaporator', 'main-description': '30 x 5 x 4-3/8 Evaporator Coil For True', 'product-id': '800245', 'oem-product-id': '800245', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'Fin Dimensions': '30 x 5 x 4-1/4', 'Style': 'Evaporator', 'Weight': '7.75'}}]}, {'recognized_attributes': {'sku': '913233', 'url': 'https://caseparts.com/Part/913233/True-Evaporator-Coils', 'title': 'evaporator', 'main-description': '2-1/2 x 5 x 45 Evaporator Coil For True', 'product-id': '913233', 'oem-product-id': '913233', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'Fin Dimensions': '45 x 5 x 2-1/8'}}]}, {'recognized_attributes': {'sku': '914919', 'url': 'https://caseparts.com/Part/914919/True-Evaporator-Coils', 'title': 'evaporator', 'main-description': '45 x 5 x 2-1/8 Evaporator Coil For True', 'product-id': '914919', 'oem-product-id': '914919', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'Fin Dimensions': '45 x 5 x 2-1/8', 'Weight': '8.20'}}]}, {'recognized_attributes': {'sku': '916431', 'url': 'https://caseparts.com/Part/916431/True-Evaporator-Coils', 'title': 'evaporator', 'main-description': '64 x 5 x 2-1/4 Evaporator Coil For True', 'product-id': '916431', 'oem-product-id': '916431', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'Fin Dimensions': '64 x 5 x 2-1/8'}}]}, {'recognized_attributes': {'sku': '800228', 'url': 'https://caseparts.com/Part/800228/True-Condenser-Coils', 'title': 'condenser', 'main-description': '9 x 7 x 2-1/2 Condenser Coil For True', 'product-id': '800228', 'oem-product-id': '800228', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'Fin Dimensions': '9 x 7-1/4 x 2-1/2', 'Style': 'Condenser', 'Weight': '2.90'}}]}, {'recognized_attributes': {'sku': '800601', 'url': 'https://caseparts.com/Part/800601/True-Condenser-Coils', 'title': 'condenser', 'main-description': 'True Condenser Coil 11 x 10 x 4', 'product-id': '800601', 'oem-product-id': '800601', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'Fin Dimensions': '11 x 11 x 4', 'Style': 'Condenser', 'Weight': '12.25'}}]}, {'recognized_attributes': {'sku': '800401', 'url': 'https://caseparts.com/Part/800401/True-Fan-Motors-and-Blades', 'title': 'evaporator', 'main-description': 'Evaporator Fan Motor For True', 'product-id': '800401', 'oem-product-id': '800401', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'AMPS': '0.53', 'Direction': 'CW', 'RPM': '1450', 'Style': 'Evaporator', 'Voltage': '115V', 'Watts': '9', 'Weight': '2.90'}}]}, {'recognized_attributes': {'sku': '800448', 'url': 'https://caseparts.com/Part/800448/True-Fan-Motors-and-Blades', 'title': 'evaporator', 'main-description': 'Evaporator Fan Motor 6W 115V CW For True', 'product-id': '800448', 'oem-product-id': '800448', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'AMPS': '0.13', 'Direction': 'CW', 'RPM': '1550', 'Style': 'Evaporator', 'Voltage': '115V', 'Watts': '6', 'Weight': '1.90'}}]}, {'recognized_attributes': {'sku': '800441', 'url': 'https://caseparts.com/Part/800441/True-Fan-Motors-and-Blades', 'title': 'evaporator', 'main-description': 'Evaporator Fan Motor 6W 115V CW For True', 'product-id': '800441', 'oem-product-id': '800441', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'AMPS': '0.13', 'Direction': 'CW', 'RPM': '1550', 'Voltage': '115V', 'Watts': '6', 'Weight': '1.95'}}]}, {'recognized_attributes': {'sku': '800404', 'url': 'https://caseparts.com/Part/800404/True-Fan-Motors-and-Blades', 'title': 'condenser', 'main-description': 'Condenser Fan Motor 230V For True', 'product-id': '800404', 'oem-product-id': '800404', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'AMPS': '0.27', 'Direction': 'CW', 'RPM': '1550', 'Style': 'Condenser', 'Voltage': '230V', 'Watts': '9', 'Weight': '2.15'}}]}, {'recognized_attributes': {'sku': '800439', 'url': 'https://caseparts.com/Part/800439/True-Fan-Motors-and-Blades', 'title': 'condenser', 'main-description': 'Condenser Fan Motor 9W 115V For True', 'product-id': '800439', 'oem-product-id': '800439', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'AMPS': '0.53', 'Direction': 'CW', 'RPM': '1550', 'Style': 'Condenser', 'Voltage': '115V', 'Watts': '9', 'Weight': '2.15'}}]}, {'recognized_attributes': {'sku': '800452', 'url': 'https://caseparts.com/Part/800452/True-Fan-Motors-and-Blades', 'title': 'condenser', 'main-description': 'Condenser Fan Motor 14W 230V For True', 'product-id': '800452', 'oem-product-id': '800452', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'AMPS': '0.13', 'Direction': 'CW', 'RPM': '1550', 'Style': 'Condenser', 'Voltage': '230V', 'Watts': '14'}}]}, {'recognized_attributes': {'sku': '217249', 'url': 'https://caseparts.com/Part/217249/True-Fan-Motors-and-Blades', 'title': 'evaporator', 'main-description': 'Evaporator Fan Motor For True', 'product-id': '217249', 'oem-product-id': '217249', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'Style': 'Evaporator', 'Voltage': '230V', 'Watts': '31', 'Weight': '1.95'}}]}, {'recognized_attributes': {'sku': '801005', 'url': 'https://caseparts.com/Part/801005/True-Fan-Motors-and-Blades', 'title': 'condenser', 'main-description': '8-3/4 Condenser Fan Blade For True', 'product-id': '801005', 'oem-product-id': '801005', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'Blades': '3', 'Diameter': '8-3/4', 'Direction': 'CW', 'Material': 'Metal', 'Pitch': '31°'}}]}, {'recognized_attributes': {'sku': '801004', 'url': 'https://caseparts.com/Part/801004/True-Fan-Motors-and-Blades', 'title': 'evaporator', 'main-description': '10 Metal Evaporator Fan Blade For True', 'product-id': '801004', 'oem-product-id': '801004', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'Blades': '5', 'Diameter': '10', 'Direction': 'CCW', 'Material': 'Metal', 'Pitch': '30°'}}]}, {'recognized_attributes': {'sku': '851125', 'url': 'https://caseparts.com/Part/851125/True-Compressors-and-Related-Parts', 'title': 'tube', 'main-description': '.036 x 7 Cap Tube For True', 'product-id': '851125', 'oem-product-id': '851125', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'ID': '.036', 'Length': '84', 'OD': '.087', 'Weight': '0.20'}}]}, {'recognized_attributes': {'sku': '851111', 'url': 'https://caseparts.com/Part/851111/True-Compressors-and-Related-Parts', 'title': 'tube', 'main-description': '.046 x 7 Cap Tube For True', 'product-id': '851111', 'oem-product-id': '851111', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'ID': '.046', 'Length': '84', 'OD': '.097', 'Weight': '0.15'}}]}, {'recognized_attributes': {'sku': '851146', 'url': 'https://caseparts.com/Part/851146/True-Compressors-and-Related-Parts', 'title': 'tube', 'main-description': '.042 x 8 Cap Tube For True', 'product-id': '851146', 'oem-product-id': '851146', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'ID': '.042', 'Length': '96', 'OD': '.093', 'Weight': '0.20'}}]}, {'recognized_attributes': {'sku': '851110', 'url': 'https://caseparts.com/Part/851110/True-Compressors-and-Related-Parts', 'title': 'tube', 'main-description': '.046 x 8 Cap Tube For True', 'product-id': '851110', 'oem-product-id': '851110', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'ID': '.046', 'Length': '96', 'OD': '.097', 'Weight': '0.20'}}]}, {'recognized_attributes': {'sku': '851165', 'url': 'https://caseparts.com/Part/851165/True-Compressors-and-Related-Parts', 'title': 'tube', 'main-description': '.054 x 8 Cap Tube For True', 'product-id': '851165', 'oem-product-id': '851165', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'ID': '.054', 'Length': '96', 'OD': '.106', 'Weight': '0.20'}}]}, {'recognized_attributes': {'sku': '851113', 'url': 'https://caseparts.com/Part/851113/True-Compressors-and-Related-Parts', 'title': 'tube', 'main-description': '.064 x 96 Cap Tube For True', 'product-id': '851113', 'oem-product-id': '851113', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'ID': '.064', 'Length': '96', 'OD': '.125', 'Weight': '0.30'}}]}, {'recognized_attributes': {'sku': '851145', 'url': 'https://caseparts.com/Part/851145/True-Compressors-and-Related-Parts', 'title': 'tube', 'main-description': '.070 x 8 Cap Tube for True', 'product-id': '851145', 'oem-product-id': '851145', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'ID': '.070', 'Length': '96', 'OD': '.125'}}]}, {'recognized_attributes': {'sku': '851100', 'url': 'https://caseparts.com/Part/851100/True-Compressors-and-Related-Parts', 'title': 'tube', 'main-description': '.036 ID x 10 Cap Tube For True', 'product-id': '851100', 'oem-product-id': '851100', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'ID': '.036', 'Length': '120', 'OD': '.087', 'Weight': '0.25'}}]}, {'recognized_attributes': {'sku': '851127', 'url': 'https://caseparts.com/Part/851127/True-Compressors-and-Related-Parts', 'title': 'tube', 'main-description': '.042 x 10 Cap Tube For True', 'product-id': '851127', 'oem-product-id': '851127', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'ID': '.042', 'Length': '120', 'OD': '.093', 'Weight': '0.20'}}]}, {'recognized_attributes': {'sku': '851138', 'url': 'https://caseparts.com/Part/851138/True-Compressors-and-Related-Parts', 'title': 'tube', 'main-description': '.046 x 10 Cap Tube For True', 'product-id': '851138', 'oem-product-id': '851138', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'ID': '.046', 'Length': '120', 'OD': '.097', 'Weight': '0.25'}}]}, {'recognized_attributes': {'sku': '851142', 'url': 'https://caseparts.com/Part/851142/True-Compressors-and-Related-Parts', 'title': 'tube', 'main-description': '.054 x 10 Cap Tube For True', 'product-id': '851142', 'oem-product-id': '851142', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'ID': '.054', 'Length': '120', 'OD': '.106', 'Weight': '0.25'}}]}, {'recognized_attributes': {'sku': '851143', 'url': 'https://caseparts.com/Part/851143/True-Compressors-and-Related-Parts', 'title': 'tube', 'main-description': '.064 x 10 Cap Tube For True', 'product-id': '851143', 'oem-product-id': '851143', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'ID': '.064', 'Length': '120', 'OD': '.125', 'Weight': '0.35'}}]}, {'recognized_attributes': {'sku': '851135', 'url': 'https://caseparts.com/Part/851135/True-Compressors-and-Related-Parts', 'title': 'tube', 'main-description': '.036 x 126 Cap Tube For True', 'product-id': '851135', 'oem-product-id': '851135', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'ID': '.036', 'Length': '126', 'OD': '.087', 'Weight': '0.20'}}]}, {'recognized_attributes': {'sku': '851133', 'url': 'https://caseparts.com/Part/851133/True-Compressors-and-Related-Parts', 'title': 'tube', 'main-description': '.046 x 12 Cap Tube For True', 'product-id': '851133', 'oem-product-id': '851133', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'ID': '.046', 'Length': '144', 'OD': '.097', 'Weight': '0.25'}}]}, {'recognized_attributes': {'sku': '851136', 'url': 'https://caseparts.com/Part/851136/True-Compressors-and-Related-Parts', 'title': 'tube', 'main-description': '.054 x 12 Cap Tube For True', 'product-id': '851136', 'oem-product-id': '851136', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'ID': '.054', 'Length': '144', 'OD': '.106', 'Weight': '0.30'}}]}, {'recognized_attributes': {'sku': '851134', 'url': 'https://caseparts.com/Part/851134/True-Compressors-and-Related-Parts', 'title': 'tube', 'main-description': '.064 x 12 Cap Tube For True', 'product-id': '851134', 'oem-product-id': '851134', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'ID': '.064', 'Length': '144', 'OD': '.125', 'Weight': '0.45'}}]}, {'recognized_attributes': {'sku': '851157', 'url': 'https://caseparts.com/Part/851157/True-Compressors-and-Related-Parts', 'title': 'tube', 'main-description': '.042 x14 Cap Tube For True', 'product-id': '851157', 'oem-product-id': '851157', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'ID': '.042', 'Length': '168', 'OD': '.093', 'Weight': '0.30'}}]}, {'recognized_attributes': {'sku': '800350', 'url': 'https://caseparts.com/Part/800350/True-Compressors-and-Related-Parts', 'title': 'valve', 'main-description': 'Crankcase Pressure Reg Valve For True', 'product-id': '800350', 'oem-product-id': '800350', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': 'N/A'}]}, {'recognized_attributes': {'sku': '800801', 'url': 'https://caseparts.com/Part/800801/True-Compressors-and-Related-Parts', 'title': 'drier', 'main-description': 'Drier For True', 'product-id': '800801', 'oem-product-id': '800801', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'Weight': '1.00'}}]}, {'recognized_attributes': {'sku': '800805', 'url': 'https://caseparts.com/Part/800805/True-Compressors-and-Related-Parts', 'title': 'drier', 'main-description': 'Freezer Drier For True', 'product-id': '800805', 'oem-product-id': '800805', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': 'N/A'}]}, {'recognized_attributes': {'sku': '870934', 'url': 'https://caseparts.com/Part/870934/True-Evaporator-Drain-Pans', 'title': 'evaporator', 'main-description': 'V-Shape Evaporator Drain Pan For True', 'product-id': '870934', 'oem-product-id': '870934', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'Length': '49', 'Style': 'Evaporator', 'Weight': '3.00', 'Width': '14-3/4'}}]}, {'recognized_attributes': {'sku': '870921', 'url': 'https://caseparts.com/Part/870921/True-Evaporator-Drain-Pans', 'title': 'evaporator', 'main-description': '50 x 11-1/2 Evaporator Cover For True', 'product-id': '870921', 'oem-product-id': '870921', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'Length': '50', 'Width': '11-1/2'}}]}, {'recognized_attributes': {'sku': '870920', 'url': 'https://caseparts.com/Part/870920/True-Evaporator-Drain-Pans', 'title': 'evaporator', 'main-description': '50 x 11-1/2 Evaporator Cover For True', 'product-id': '870920', 'oem-product-id': '870920', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'Length': '50', 'Style': 'Evaporator', 'Weight': '5.85', 'Width': '11-1/2'}}]}, {'recognized_attributes': {'sku': '875953', 'url': 'https://caseparts.com/Part/875953/True-Evaporator-Drain-Pans', 'title': 'evaporator', 'main-description': '50 x 11-1/2 Evaporator Cover For True', 'product-id': '875953', 'oem-product-id': '875953', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'Length': '50', 'Width': '11-3/4'}}]}, {'recognized_attributes': {'sku': '801815', 'url': 'https://caseparts.com/Part/801815/True-Condensate-Pans,-Wicking-and-Heaters', 'title': 'condenser', 'main-description': '200W 115V Condenser Pan Heater For True', 'product-id': '801815', 'oem-product-id': '801815', 'compliant-with': 'N/A', 'manufacturer': 'true'}, 'all_extracted_data': [{'extraction_priority': 1, 'section_name': 'details', 'media_type': 'text', 'format_type': 'json', 'content': {'Dimensions': '17 x 4-1/2', 'Voltage': '115V', 'Volts': '115V', 'Watts': '200W', 'Weight': '0.70'}}]}]
for each_part in parts:
    # print(each_part, "MMMM<<<<<<<<<<<<<<<<<<<<<<<<")
    list_parts_json = []
    for dict_json in product_json_final:
        title_check = dict_json["recognized_attributes"]["title"]
        # print(title_check)
        if title_check.lower() == each_part.lower():
            list_parts_json.append(dict_json)
    print(len(list_parts_json))
    if len(list_parts_json) != 0:
        print("pushed data", " &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&")
        print(list_parts_json)
        data_to_database(list_parts_json, each_part)
